@startuml

title Camera Controller State Diagram

state idle
idle : front cam. off
idle : rear cam. off

state "Front cam. on" as frontTimer
frontTimer : timer
frontTimer : rear cam. off

state "Rear cam. on" as rearTimer
rearTimer : timer
rearTimer : front cam. off

state "Reversing" as reversing {
    state "Rear cam. on" as reversingRearOn
    reversingRearOn : front off

    state "Front cam. on" as reveringFrontTimer
    reveringFrontTimer : timer
    reveringFrontTimer : rear cam. off

    [*] --> reversingRearOn
    reversingRearOn -> reveringFrontTimer : button pressed
    reveringFrontTimer -> reversingRearOn : timer timeout
    reveringFrontTimer -> reversingRearOn : button pressed
    reversingRearOn --> [*]
}

[*] --> frontTimer

frontTimer --> idle : timer timeout
frontTimer -left-> rearTimer : button pressed
frontTimer -> reversing : reverse gear set

idle -> idle : waiting for input
idle --> reversing : reverse gear set
idle --> frontTimer : button pressed

rearTimer --> idle : timer timeout
rearTimer --> idle : button pressed
rearTimer --> reversing : reverse gear set


reversing -> frontTimer : reverse gear unset
@enduml